knitr::opts_chunk$set(cache=TRUE) # caching to increase knitting time when document is too big
set.seed(2015) # set seed
library(pacman)
p_load(RSocrata,plyr,RColorBrewer,hash, mosaic, ggmap, stringr) # these are all the packages that we have used
load("../Data/restaurantClean.Rda") # This should be the correct path to the dataset we need
View(restaurant.clean)
densityplot(rodent_list ~ median_income.list, data=restaurant.clean)
densityplot( ~ median_income.list, groups=rodent_list, data=restaurant.clean)
densityplot( ~ log(median_income.list), groups=rodent_list, data=restaurant.clean)
densityplot( ~ log(median_income.list), groups=roach_list, data=restaurant.clean)
densityplot( ~ log(median_income.list), groups=rodent_list, data=restaurant.clean, main="Roaches and Income")
densityplot( ~ log(median_income.list), groups=roach_list, data=restaurant.clean, main="Roaches and Income")
qqnorm(boot.rodent)
bwplot((restaurant.clean$score) ~ restaurant.clean$cuisine_group_factor, main = "Boxplot for Score and Cuisine Group", xlab = "Cuisine Group", ylab = "Score")
library(pacman)
p_load(RSocrata,plyr,RColorBrewer,hash, mosaic, ggmap, stringr)
restaurant.clean <- subset(restaurant.clean, score != -1, drop = T)
load("~/Dropbox/RestaurantInspection/Data/restaurantCleanWithAddress.Rda")
load("~/Dropbox/RestaurantInspection/Data/restaurantClean.Rda")
restaurant.clean <- subset(restaurant.clean, score != -1, drop = T)
#restaurant.clean <- subset(restaurant.clean, !is.na(grade) | grade != "NA")
set.seed(2015)
#### Chinese Restaurants (V) ####
# General Statistics
bwplot((restaurant.clean$score) ~ restaurant.clean$cuisine_group_factor, main = "Boxplot for Score and Cuisine Group", xlab = "Cuisine Group", ylab = "Score")
t.test(chinese.restaurant, conf.level = 0.99)$conf
t.test(chinese.restaurant, conf.level = 0.99)$conf
chinese.restaurant <- subset((restaurant.clean), select = score, cuisine_group_factor == "Chinese", drop = T)
other.restaurant <- subset((restaurant.clean), select = score, cuisine_group_factor != "Chinese", drop = T)
t.test(chinese.restaurant, conf.level = 0.99)$conf
t.test(chinese.restaurant, conf.level = 0.95)$conf
N <- 10^4-1
m <- length(chinese.restaurant)
total <- length(chinese.restaurant) + length(other.restaurant)
meanDiff <- numeric(N)
trmeanDiff <- numeric(N)
for(i in 1 : N)
{
index <- sample(total, m, replace = FALSE)
meanDiff[i] <- mean((restaurant.clean$score[index])) -
mean((restaurant.clean$score[-index]))
trmeanDiff[i] <- mean((restaurant.clean$score[index]), trim = 0.25) -
mean((restaurant.clean$score[-index]), trim = 0.25)
}
#mean
observed.mean.diff <- mean(chinese.restaurant) - mean(other.restaurant)
histogram(meanDiff,
xlab = "Chinese Avg Score - Other Avg Score",
main="Perm. Test b/w Chinese & Other cuisine",
v = observed.mean.diff)
(sum(meanDiff > observed.mean.diff) +1) / (N+1) # p-val
```
#trimmed mean
observed.trmean.diff <- mean(chinese.restaurant, trim = 0.25) -
mean(other.restaurant, trim = 0.25)
histogram(trmeanDiff,
xlab = "Chinese Trimmed Median Score - Other Trimmed Median Score",
main="Perm. Test b/w Chinese & Other cuisine",
v = observed.trmean.diff)
(sum(trmeanDiff > observed.trmean.diff) +1) / (N+1) # p-val
summary(restaurant.clean)
favstats(~restaurant.clean)
favstats(~restaurant.clean$score)
favstats(~chinese.restaurant)
favstats(~asian.restaurant)
asian.restaurant <- subset((restaurant.clean), select = score, cuisine_group_factor == "Asian", drop = T)
favstats(~chinese.restaurant)
favstats(~asian.restaurant)
xyplot(sqrt(score)~median_income.list | cuisine_group_factor, data = restaurant.clean)
xyplot(sqrt(score)~ log(median_income.list) | cuisine_group_factor, data = restaurant.clean)
xyplot(sqrt(score)~ log(median_income.list) | cuisine_group_factor, data = restaurant.clean)
fit<- lm(sqrt(score)~ median_income.list, data=restaurant.clean)
summary(fit)
fit<- lm(sqrt(score)~ median_income.list, data=restaurant.clean)
summary(fit)
fit<- lm(sqrt(score)~ log(median_income.list), data=restaurant.clean)
summary(fit)
fit<- lm(sqrt(score)~ log(median_income.list), data=restaurant.clean)
summary(fit)
fit<- lm(sqrt(score)~ log(median_income.list), data=restaurant.clean)
summary(fit)
fit<- lm(sqrt(score)~ median_income.list, data=restaurant.clean)
summary(fit)
fit<- lm(sqrt(score)~ log(median_income.list), data=restaurant.clean)
#### Assumptions ####
summary(fit)
fit<- lm(sqrt(score)~ median_income.list, data=restaurant.clean)
summary(fit)
cor(score, median_income.list)
cor(score, median_income.list, data = restaurant.clean)
cor(sqrt(score), median_income.list, data = restaurant.clean)
cor(sqrt(score), log(median_income.list), data=restaurant.clean)
xyplot(sqrt(score)~median_income.list, data = restaurant.clean)
xyplot(sqrt(score)~median_income.list, data = restaurant.clean)
cor(sqrt(score), median_income.list, data = restaurant.clean)
summary(restaurant.clean$score)
favstats(restaurant.clean$score)
tally(restaurant.clean$score)
cor(sqrt(score), median_income.list, data = restaurant.clean, use="complete")
cor(score, median_income.list, data = restaurant.clean, use="complete")
cor(sqrt(score), median_income.list, data = restaurant.clean, use="complete")
cor(score, median_income.list, data = restaurant.clean, use="complete")
xyplot(sqrt(score)~median_income.list | cuisine_group_factor, data = restaurant.clean)
xyplot(sqrt(score)~ log(median_income.list) | cuisine_group_factor, data = restaurant.clean)
fit<- lm(sqrt(score)~cuisine_group_factor + median_income.list, data=restaurant.clean)
summary(fit)
qqnorm(residuals(fit))
qqline(residuals(fit))
histogram(residuals(fit))
fit_2<- lm(sqrt(score)~median_income.list, data=restaurant.clean)
qqnorm(residuals(fit_2))
qqline(residuals(fit_2))
histogram(residuals(fit_2))
aic <- c(AIC(fit), AIC(fit_2))
aic
tally(restaurant.clean$score)
tally(~restaurant.clean$score)
cor(score, median_income.list, data = restaurant.clean, use="complete")
xyplot(sqrt(score)~median_income.list, data = restaurant.clean)
xyplot(sqrt(score)~log(median_income.list), data = restaurant.clean)
cor(score, median_income.list, data = restaurant.clean, use="complete")
xyplot(sqrt(score)~median_income.list), data = restaurant.clean)
xyplot(sqrt(score)~median_income.list, data = restaurant.clean)
cor(score, median_income.list, data = restaurant.clean, use="complete")
cor(sqrt(score), median_income.list, data = restaurant.clean, use="complete")
cor(sqrt(score), log(median_income.list), data = restaurant.clean, use="complete")
cor(score, median_income.list, data = restaurant.clean)
, use="complete"
cor(score, median_income.list, data = restaurant.clean, use="complete")
tally(~restaurant.clean$median_income.list)
fit_2<- lm(sqrt(score)~median_income.list, data=restaurant.clean)
summary(fit_2)
fit_2<- lm(sqrt(score)~log(median_income.list), data=restaurant.clean)
summary(fit_2)
fit_2<- lm(sqrt(score)~median_income.list, data=restaurant.clean)
summary(fit_2)
fit_2<- lm(sqrt(score)~median_income.list, data=restaurant.clean)
summary(fit_2)
xyplot(residuals(fit_2) - fit_2$fitted.values, data = restaurant.clean, type = c(“p”, “r”), lty = 3,
xyplot(residuals(fit_2) - fit_2$fitted.values, data = restaurant.clean, type = c(“p”, “r”), lty = 3,
main = “Scatterplot for Residuals and Fitted Value”,
xlab = “Fitted Values, ylab = “Residual”)
xyplot(residuals(fit_2) - fit_2$fitted.values, data = restaurant.clean, type = c(“p”, “r”), lty = 3,
main = “Scatterplot for Residuals and Fitted Value”,
xlab = “Fitted Values, ylab = “Residual”)
xyplot(residuals(fit_2) - fit_2$fitted.values, data = restaurant.clean, type = c(“p”, “r”), lty = 3,
main = "Scatterplot for Residuals and Fitted Value”,
xlab = "Fitted Values", ylab = “Residual”)
xyplot(residuals(fit_2) - fit_2$fitted.values, data = restaurant.clean, type = c("p", "r"), lty = 3,
main = "Scatterplot for Residuals and Fitted Value",
xlab = "Fitted Values", ylab = "Residual")
xyplot(residuals(fit_2) ~ fit_2$fitted.values, data = restaurant.clean, type = c("p", "r"),
lty = 3,
main = "Scatterplot for Residuals and Fitted Value",
xlab = "Fitted Values", ylab = "Residual")
histogram(~residuals(fit_2))
qqnorm(residuals(fit_2))
qqline(residuals(fit_2))
xyplot(residuals(fit_2) ~ fit_2$fitted.values, data = restaurant.clean, type = c("p", "r"),
lty = 3, main = "Scatterplot for Residuals and Fitted Value",
xlab = "Fitted Values", ylab = "Residual")
histogram(~residuals(fit_2))
xyplot(residuals(fit_2) ~ fit_2$fitted.values, data = restaurant.clean, type = c("p", "r"),
lty = 3, main = "Scatterplot for Residuals and Fitted Value",
xlab = "Fitted Values", ylab = "Residual")
xyplot(residuals(fit_2) ~ fit_2$fitted.values, data = restaurant.clean, type = c("p", "r"),
lty = 3, main = "Scatterplot for Residuals and Fitted Value",
xlab = "Fitted Values", ylab = "Residual")
fit<- lm(sqrt(score)~ median_income.list, data=restaurant.clean)
summary(fit)
histogram(~residuals(fit), main = "Histogram of residuals", xlab = "Residuals")
qqnorm(residuals(fit))
qqline(residuals(fit))
xyplot(sqrt(score)~median_income.list | cuisine_group_factor, data = restaurant.clean)
xyplot(sqrt(score)~median_income.list | cuisine_group_factor, data = restaurant.clean)
fit_2<- lm(sqrt(score)~cuisine_group_factor + median_income.list, data=restaurant.clean)
summary(fit_2)
xyplot(residuals(fit) ~ fit$fitted.values, data = restaurant.clean, type = c("p", "r"),
lty = 3, main = "Scatterplot for Residuals and Fitted Value",
xlab = "Fitted Values", ylab = "Residual")
fit_2<- lm(sqrt(score)~cuisine_group_factor + median_income.list, data=restaurant.clean)
summary(fit_2)
xyplot(residuals(fit_2) ~ fit_2$fitted.values, data = restaurant.clean, type = c("p", "r"),
lty = 3, main = "Scatterplot for Residuals and Fitted Value",
xlab = "Fitted Values", ylab = "Residual")
histogram(~residuals(fit_2), main = "Histogram of residuals", xlab = "Residuals")
qqnorm(residuals(fit_2))
qqline(residuals(fit_2))
histogram(~residuals(fit_2), main = "Histogram of residuals", xlab = "Residuals")
qqnorm(residuals(fit_2))
histogram(~residuals(fit), main = "Histogram of residuals", xlab = "Residuals")
qqnorm(residuals(fit))
qqline(residuals(fit))
fit_2<- lm(sqrt(score)~cuisine_group_factor + median_income.list, data=restaurant.clean)
summary(fit_2)
histogram(~residuals(fit_2), main = "Histogram of residuals", xlab = "Residuals")
qqnorm(residuals(fit_2))
qqline(residuals(fit_2))
xyplot(residuals(fit_2) ~ fit_2$fitted.values, data = restaurant.clean, type = c("p", "r"),
lty = 3, main = "Scatterplot for Residuals and Fitted Value",
xlab = "Fitted Values", ylab = "Residual")
xyplot(residuals(fit_2) ~ fit_2$fitted.values, data = restaurant.clean, type = c("p", "r"),
lty = 3, main = "Scatterplot for Residuals and Fitted Value",
xlab = "Fitted Values", ylab = "Residual")
histogram(~residuals(fit_2), main = "Histogram of residuals", xlab = "Residuals")
qqnorm(residuals(fit_2))
qqline(residuals(fit_2))
fit_2<- lm(sqrt(score)~cuisine_group_factor + median_income.list, data=restaurant.clean)
summary(fit_2)
fit_2<- lm(sqrt(score)~cuisine_group_factor + median_income.list, data=restaurant.clean)
summary(fit_2)
